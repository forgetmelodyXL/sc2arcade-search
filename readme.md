# koishi-plugin-sc2arcade-search

<a href="https://sc2arcade.com">
  <img src="https://sc2arcade.com/img/arcade-logo.a514b842.png" alt="arcade-logo">
</a>

[![npm](https://img.shields.io/npm/v/koishi-plugin-sc2arcade-search?style=flat-square)](https://www.npmjs.com/package/koishi-plugin-sc2arcade-search)

提供星际争霸2游戏大厅相关查询功能的 Koishi 插件，支持房间状态查询、战绩查询、地图绑定等功能。

## ✨ 功能特性

- 🎮 实时查询游戏大厅房间状态
- 📊 玩家战绩/场次统计查询
- 🔗 用户与游戏句柄绑定系统
- 🗺️ 群组地图绑定功能
- ⚡ 支持代理服务器配置
- 🔒 敏感词过滤功能

## 📦 安装

```bash
npm install koishi-plugin-sc2arcade-search
```

## ⚙️ 配置项

```ts
proxyAgent: 'http://your-proxy-server:port' // 代理服务器地址（为空则不使用）
```

## 📋 命令列表

### 👤 玩家相关
| 命令                           | 功能描述                     | 示例                               |
|------------------------------|----------------------------|-----------------------------------|
| 绑定                | 绑定游戏句柄                  | `/绑定` → 输入`1-S2-1-123456`      |
| 解绑                | 解绑游戏句柄                  | `/解绑`                           |
| 句柄 [@用户]        | 查询绑定信息                  | `/句柄 @小明`                     |
| 战绩 [@用户]        | 查询最近20场战绩              | `/战绩 @小明`                     |
| 场数 [@用户]        | 查询游戏场次排行              | `/场数`                           |

### 🌐 房间相关
| 命令                           | 功能描述                     | 示例                               |
|------------------------------|----------------------------|-----------------------------------|
| 大厅                | 查询指定区域大厅房间           | `/大厅` → 输入`KR`                |
| 房间                | 查询群组绑定地图的等待房间      | `/房间`                           |
| 历史房间            | 查询已开始的房间历史           | `/历史房间`                       |

### 👥 群组管理
| 命令                           | 权限 | 功能描述              |
|------------------------------|-----|---------------------|
| 绑定地图            | 3   | 绑定群组地图        |
| 解绑地图            | 3   | 解除群组地图绑定        |
| 场数排行            | -   | 查询群组地图玩家场次排行     |
| 更新日志            | -   | 查看群组地图更新历史        |

### ⚠️注意事项

- 玩家使用之前需要先绑定游戏句柄。
- 群组使用之前需要先绑定地图。
- [@用户] 为可选参数，不输入则查询自己信息。

## 💻 使用示例

```bash
/绑定
> 请输入句柄格式: [区域ID]-S2-[服务器ID]-[档案ID]
例如：1-S2-1-123456

/绑定地图
> 请输入URL格式: https://sc2arcade.com/map/[区域ID]/[地图ID]/
例如：https://sc2arcade.com/map/1/123456/

/大厅
1. 地图：沙漠风暴 人数: 3/8
2. 地图：星际酒馆 人数: 6/8

/战绩
1. 地图: 沙漠风暴, 结果: 胜利
2. 地图: 星际酒馆, 结果: 失败
```

## ⚠️ 注意事项

- 🔌 **代理配置**：需要配置有效的代理服务器地址（部分地区需要）
- 🔤 **句柄格式**：严格遵循 `区域ID-S2-服务器ID-档案ID` 格式
- 🚫 **敏感词过滤**：玩家名称会自动进行敏感词过滤处理
- 💾 **数据缓存**：绑定信息默认存储在数据库，重启后保留

## 📃 更新日志
<details>
<summary>点我查看更新日志详情</summary>

### ✨ 1.1.21
  - 使用新的敏感词检测API，提高检测率
  - 新增一个配置项

### ✨ 1.1.20
  - 优化数据库表

### ✨ 1.1.19
  - 添加了引用回复

### ✨ 1.1.16 & 1.1.17 & 1.1.18
  - 修改部分文字描述
  - 删除几处不合理的emoji表情

### ✨ 1.1.14 & 1.1.15
  - 修改部分文字描述

### ✨ 1.1.12 & 1.1.13
  - 优化了敏感词API检测
  - 添加了游戏大厅玩家名称缓存数据库

### ✨ 1.1.11
  - 删除几处不合理的emoji表情

### ✨ 1.1.8
  - 优化了[@用户]的代码逻辑

### ✨ 1.1.7
  - 修改了几处emoji表情

### ✨ 1.1.6
  - 更新readme.md
  - 优化代码

### ✨ 1.1.0
  - 上传正式版

</details>

## 📄 License

本项目采用 MIT 许可证。
